{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useCallback, useEffect } from 'react';\nimport { ethers } from 'ethers';\nexport function useWallet() {\n  _s();\n  const [wallet, setWallet] = useState({\n    account: '',\n    provider: null,\n    signer: null,\n    chainId: 0,\n    isConnected: false\n  });\n  const [isConnecting, setIsConnecting] = useState(false);\n  const [error, setError] = useState('');\n  const connect = useCallback(async () => {\n    if (typeof window.ethereum === 'undefined') {\n      setError('MetaMask not installed');\n      return;\n    }\n    setIsConnecting(true);\n    setError('');\n    try {\n      await window.ethereum.request({\n        method: 'wallet_requestPermissions',\n        params: [{\n          eth_accounts: {}\n        }]\n      });\n      const provider = new ethers.BrowserProvider(window.ethereum);\n      const signer = await provider.getSigner();\n      const address = await signer.getAddress();\n      const network = await provider.getNetwork();\n      setWallet({\n        account: address,\n        provider,\n        signer,\n        chainId: Number(network.chainId),\n        isConnected: true\n      });\n    } catch (err) {\n      setError(err.message || 'Failed to connect wallet');\n    } finally {\n      setIsConnecting(false);\n    }\n  }, []);\n  const disconnect = useCallback(() => {\n    setWallet({\n      account: '',\n      provider: null,\n      signer: null,\n      chainId: 0,\n      isConnected: false\n    });\n    setError('');\n  }, []);\n  useEffect(() => {\n    if (typeof window.ethereum === 'undefined') return;\n    const handleAccountsChanged = accounts => {\n      if (accounts.length === 0) {\n        disconnect();\n      } else if (wallet.isConnected && accounts[0] !== wallet.account) {\n        connect();\n      }\n    };\n    const handleChainChanged = () => {\n      window.location.reload();\n    };\n    window.ethereum.on('accountsChanged', handleAccountsChanged);\n    window.ethereum.on('chainChanged', handleChainChanged);\n    return () => {\n      window.ethereum.removeListener('accountsChanged', handleAccountsChanged);\n      window.ethereum.removeListener('chainChanged', handleChainChanged);\n    };\n  }, [wallet.account, wallet.isConnected, connect, disconnect]);\n  return {\n    ...wallet,\n    connect,\n    disconnect,\n    isConnecting,\n    error\n  };\n}\n_s(useWallet, \"Klx8u68ePJVsx865DuW7Ooj0V7w=\");","map":{"version":3,"names":["useState","useCallback","useEffect","ethers","useWallet","_s","wallet","setWallet","account","provider","signer","chainId","isConnected","isConnecting","setIsConnecting","error","setError","connect","window","ethereum","request","method","params","eth_accounts","BrowserProvider","getSigner","address","getAddress","network","getNetwork","Number","err","message","disconnect","handleAccountsChanged","accounts","length","handleChainChanged","location","reload","on","removeListener"],"sources":["C:/Users/Leo/OneDrive/Documentos/Faculdade INSA/Blockchain/project/flash-loan-project/frontend/src/hooks/useWallet.ts"],"sourcesContent":["import { useState, useCallback, useEffect } from 'react';\r\nimport { ethers } from 'ethers';\r\nimport { WalletState } from '../types';\r\n\r\ndeclare global {\r\n  interface Window {\r\n    ethereum?: any;\r\n  }\r\n}\r\n\r\nexport function useWallet() {\r\n  const [wallet, setWallet] = useState<WalletState>({\r\n    account: '',\r\n    provider: null,\r\n    signer: null,\r\n    chainId: 0,\r\n    isConnected: false,\r\n  });\r\n  const [isConnecting, setIsConnecting] = useState(false);\r\n  const [error, setError] = useState<string>('');\r\n\r\n  const connect = useCallback(async () => {\r\n    if (typeof window.ethereum === 'undefined') {\r\n      setError('MetaMask not installed');\r\n      return;\r\n    }\r\n\r\n    setIsConnecting(true);\r\n    setError('');\r\n\r\n    try {\r\n      await window.ethereum.request({\r\n        method: 'wallet_requestPermissions',\r\n        params: [{ eth_accounts: {} }],\r\n      });\r\n\r\n      const provider = new ethers.BrowserProvider(window.ethereum);\r\n      const signer = await provider.getSigner();\r\n      const address = await signer.getAddress();\r\n      const network = await provider.getNetwork();\r\n\r\n      setWallet({\r\n        account: address,\r\n        provider,\r\n        signer,\r\n        chainId: Number(network.chainId),\r\n        isConnected: true,\r\n      });\r\n    } catch (err: any) {\r\n      setError(err.message || 'Failed to connect wallet');\r\n    } finally {\r\n      setIsConnecting(false);\r\n    }\r\n  }, []);\r\n\r\n  const disconnect = useCallback(() => {\r\n    setWallet({\r\n      account: '',\r\n      provider: null,\r\n      signer: null,\r\n      chainId: 0,\r\n      isConnected: false,\r\n    });\r\n    setError('');\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (typeof window.ethereum === 'undefined') return;\r\n\r\n    const handleAccountsChanged = (accounts: string[]) => {\r\n      if (accounts.length === 0) {\r\n        disconnect();\r\n      } else if (wallet.isConnected && accounts[0] !== wallet.account) {\r\n        connect();\r\n      }\r\n    };\r\n\r\n    const handleChainChanged = () => {\r\n      window.location.reload();\r\n    };\r\n\r\n    window.ethereum.on('accountsChanged', handleAccountsChanged);\r\n    window.ethereum.on('chainChanged', handleChainChanged);\r\n\r\n    return () => {\r\n      window.ethereum.removeListener('accountsChanged', handleAccountsChanged);\r\n      window.ethereum.removeListener('chainChanged', handleChainChanged);\r\n    };\r\n  }, [wallet.account, wallet.isConnected, connect, disconnect]);\r\n\r\n  return {\r\n    ...wallet,\r\n    connect,\r\n    disconnect,\r\n    isConnecting,\r\n    error,\r\n  };\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}